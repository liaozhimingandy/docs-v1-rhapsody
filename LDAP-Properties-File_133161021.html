<!doctype html>
<html>
 <head> 
  <title>LDAP Properties File</title> 
  <link rel="stylesheet" href="styles/site.css" type="text/css"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <link rel="stylesheet" href="styles/icons.css" type="text/css">
  <script src="js/jquery.min.js"></script>
  <script src="tree/collapsibleTreeMenu.js"></script>
  <link href="tree/collapsibleTreeMenu.css" rel="stylesheet" type="text/css">
 </head> 
 <body class="theme-default aui-theme-default"> 
  <div id="page"> 
   <div id="main" class="aui-page-panel"> 
    <div id="main-header"> 
     <div id="breadcrumb-section"> 
      <ol id="breadcrumbs">  
       <li> <span><a href="Rhapsody-Integration-Engine-6.5_133160975.html">Rhapsody Integration Engine 6.5</a></span> </li> 
       <li> <span><a href="Administering-Rhapsody_133160982.html">Administering Rhapsody</a></span> </li> 
       <li> <span><a href="Access-Control-in-Rhapsody_133160999.html">Access Control in Rhapsody</a></span> </li> 
       <li> <span><a href="LDAP-Integration_133161020.html">LDAP Integration</a></span> </li> 
      </ol> 
     </div> 
     <h1 id="title-heading" class="pagetitle"> <span id="title-text">LDAP Properties File</span> </h1> 
    </div> 
    <div id="content" class="view">  
     <div id="main-content" class="wiki-content group"> 
      <p>The <code>ldap.properties</code> file is used to configure Rhapsody's LDAP settings. It is located in the Rhapsody installation directory in&nbsp;<code>/rhapsody/data/users/ldap.properties</code>, or wherever the data directory has been relocated. It is automatically created when Rhapsody starts or restarts (if the file does not already exist).</p>
      <p>Rhapsody reloads <code>ldap.properties</code>&nbsp;file&nbsp;every time the user logs in, or based on the period set in the&nbsp;<a href="#LDAPPropertiesFile-RefreshofLDAPUsers">LDAP refresh property</a>. Therefore, any changes made to the&nbsp;<code>ldap.properties</code>&nbsp;file&nbsp;take effect when the user next logs in, or according to the <a href="#LDAPPropertiesFile-RefreshofLDAPUsers">LDAP refresh property</a>&nbsp;(it may take a few seconds for Rhapsody to synchronize with the LDAP server).</p>
      <div class="confluence-information-macro confluence-information-macro-tip">
       <span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span>
       <div class="confluence-information-macro-body">
        Click on 
        <a href="attachments/133161021/133161022.properties" data-linked-resource-id="133161022" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="ldap.properties" data-linked-resource-content-type="application/octet-stream" data-linked-resource-container-id="133161021" data-linked-resource-container-version="1">ldap.properties</a> to view the properties file generated by Rhapsody.
       </div>
      </div>
      <p>The following attributes need to be configured:</p>
      <p><style type="text/css">/*<![CDATA[*/
div.rbtoc1565146935383 {padding: 0px;}
div.rbtoc1565146935383 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1565146935383 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style></p>
      <div class="toc-macro rbtoc1565146935383"> 
       <ul class="toc-indentation"> 
        <li><a href="#LDAPPropertiesFile-Enabling/DisablingLDAP">Enabling/Disabling LDAP</a></li> 
        <li><a href="#LDAPPropertiesFile-RefreshofLDAPUsers">Refresh of LDAP Users</a></li> 
        <li><a href="#LDAPPropertiesFile-LDAPServerConnections(MultipleServers)">LDAP Server Connections (Multiple Servers)</a> 
         <ul class="toc-indentation"> 
          <li><a href="#LDAPPropertiesFile-SSLCertificatesinFiles">SSL Certificates in Files</a></li> 
          <li><a href="#LDAPPropertiesFile-SSLCertificatesinJavaKeystoreFile">SSL Certificates in Java Keystore File</a></li> 
          <li><a href="#LDAPPropertiesFile-ExpiredSSLCertificates">Expired SSL Certificates</a></li> 
         </ul> </li> 
        <li><a href="#LDAPPropertiesFile-Login">Login</a></li> 
        <li><a href="#LDAPPropertiesFile-UserBase/GroupBase">UserBase/GroupBase</a></li> 
        <li><a href="#LDAPPropertiesFile-Attributes">Attributes</a></li> 
        <li><a href="#LDAPPropertiesFile-Mappings">Mappings</a></li> 
        <li><a href="#LDAPPropertiesFile-AdministratorLoginonFailure">Administrator Login on Failure</a></li> 
       </ul> 
      </div>
      <p></p>
      <h2 id="LDAPPropertiesFile-Enabling/DisablingLDAP"><strong>Enabling/Disabling LDAP</strong></h2>
      <p>This property enables or disables LDAP.</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Authenticate Rhapsody users using LDAP
ldap=true</pre> 
       </div>
      </div>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Authenticate Rhapsody users against internal user list
ldap=false</pre> 
       </div>
      </div>
      <ul>
       <li>Values can be changed without starting Rhapsody.</li>
       <li>Default value is <code>false</code>.</li>
      </ul>
      <h2 id="LDAPPropertiesFile-RefreshofLDAPUsers"><strong>Refresh of LDAP Users</strong></h2>
      <p>This property controls how often the Rhapsody user list is synchronized with the LDAP server.</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Update counts and lists of users shown in the Management Console at 2am every day
ldap.refresh.cron=0 0 2 * * ? *</pre> 
       </div>
      </div>
      <ul>
       <li>Updates the list of users shown in the Management Console.</li>
       <li>Updates the count of users for each Access Group shown in the User Manager in Rhapsody IDE.</li>
       <li>Refreshes using a cron expression. Refer to <a href="Scheduling_133162178.html#Scheduling-AdvancedScheduling">Advanced Scheduling</a> for details on how to write a cron expression for Rhapsody.&nbsp;&nbsp;</li>
       <li>Default refresh is every day at 2am (<code>0 0 2 * * ? *</code>).</li>
       <li>When refreshing thousands of users over a slow remote connection, refresh times may exceed 30 seconds.</li>
       <li>If the <code>ldap.properties</code> file has been edited and the user manager is open, an unscheduled refresh will start.</li>
      </ul>
      <h2 id="LDAPPropertiesFile-LDAPServerConnections(MultipleServers)"><strong>LDAP Server Connections (Multiple Servers)</strong></h2>
      <p>This property specifies LDAP servers. If the network has both a main LDAP server and a redundant backup LDAP server, it is highly recommended that you specify both of these, as users would not be able to login to Rhapsody if none of the listed LDAP servers are reachable.</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Connect to LDAP server "dc1" on default LDAP port
server.1.host=dc1

# Connect to LDAP server 10.0.0.2 on non-standard port 12345
server.2.host=10.0.0.2
server.2.port=12345
</pre> 
       </div>
      </div>
      <ul>
       <li>Multiple servers can be supplied.</li>
       <li>Tries to connect to the servers in order by their number: server 1 is tried before server 2 and so on.</li>
       <li>Port defaults to <code>389</code> for non-SSL.</li>
       <li>Port defaults to <code>636</code> for SSL.</li>
      </ul>
      <h3 id="LDAPPropertiesFile-SSLCertificatesinFiles">SSL Certificates in Files</h3>
      <p>This property specifies the certificate to use to identify the LDAP server when using LDAPS (LDAP over SSL). Using LDAPS results in the connection between Rhapsody and the LDAP server being encrypted. A different certificate can be specified for each LDAP server, and multiple certificates can be provided for each server. There is also the option to auto-fetch the certificate from the LDAP server (disabled by default)<span style="line-height: 13.0pt;background-color: transparent;">. Automatically fetching the certificate should only be done over a trusted network.</span></p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Connect to LDAP server on dc1 with default SSL LDAP port and SSL
# The SSL certificate is stored in ldap.1.cer. If the certificate is
# missing, it is fetched and stored while connecting.
server.1.host=dc1
server.1.ssl=true
server.1.autofetch=true

# Connect to LDAP server on 10.0.0.2 with SSL. The LDAP certificate is in
# ldap-failover.cer. Fail to connect if the certificate is missing
server.2.host=10.0.0.2
server.2.ssl=true
server.2.autofetch=false
server.2.cert.file.1=ldap-failover.cer

# To cater for updating certificates on the LDAP server, supply three
# certificate files
server.3.host=dc3
server.3.ssl=true
server.3.cert.file.1=last_year.cer
server.3.cert.file.2=current_year.cer
server.3.cert.file.3=next_year.cer
</pre> 
       </div>
      </div>
      <h3 id="LDAPPropertiesFile-SSLCertificatesinJavaKeystoreFile"><strong>SSL Certificates in Java Keystore File</strong></h3>
      <p>This property specifies a Java Keystore that contains the certificates used to identify the&nbsp;LDAP server when using LDAPS (LDAP over SSL). Using LDAPS results in the connection between Rhapsody and the LDAP server being encrypted.&nbsp;</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Connect to dc1 and fallback to 10.0.0.2. Both with SSL and default ports
# Certificates for LDAP servers stored in Java keystore file ldap.ks.

server.1.host=dc1
server.1.ssl=true

server.2.host=10.0.0.2
server.2.ssl=true

ssl.keystore.file=ldap.ks
ssl.keystore.password=changeit
</pre> 
       </div>
      </div>
      <h3 id="LDAPPropertiesFile-ExpiredSSLCertificates"><strong>Expired SSL Certificates</strong></h3>
      <p>This property controls whether Rhapsody should allow the LDAP server to present expired certificates to identify itself. Although it is not a recommended security practice to accept expired certificates, this may be required in some networks.</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Connect to SSL LDAP severs with expired certificates.
accept.expired.certs=true</pre> 
       </div>
      </div>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># Do not connect to SSL LDAP servers with expired certificates.
accept.expired.certs=false</pre> 
       </div>
      </div>
      <h2 id="LDAPPropertiesFile-Login"><strong>Login</strong></h2>
      <p>This property specifies the name and password that Rhapsody can use to login to the LDAP server in order to query the LDAP server. It is recommended that a special user be created on the LDAP server for this purpose.</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># User for querying LDAP specified by DistinguishedName (DN)
login=CN=DomainSupportUser,OU=SupportStaff,DC=acmelabs,DC=internal
password=secret
</pre> 
       </div>
      </div>
      <p><span style="color: rgb(0,0,0);">In general, you can use special characters within a value. However, certain special characters require an additional escape character. The special characters that must be escaped when used in value are determined by the LDAP server you are connecting to. In the following example, <span style="color: rgb(255,0,0);"><code>"</code></span> and <span style="color: rgb(255,0,0);"><code>,</code></span> are escaped:</span></p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre>login=CN=\"Service Account\, rhapsody\"</pre> 
       </div>
      </div>
      <h2 id="LDAPPropertiesFile-UserBase/GroupBase"><strong>UserBase/GroupBase</strong></h2>
      <p>These properties specify the&nbsp;DN ending for LDAP users and groups.</p>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre>userBase=DC=acmelabs,DC=internal
groupBase=DC=acmelabs,DC=internal</pre> 
       </div>
      </div>
      <h2 id="LDAPPropertiesFile-Attributes"><strong>Attributes</strong></h2>
      <p>Depending on the server, these properties specify the LDAP attributes to read user and group information from:</p>
      <ul>
       <li><em>Microsoft® Active Directory</em>.</li>
       <li>OpenLDAP.</li>
      </ul>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># LDAP attribute names for Microsoft Active Directory
userClass=user
groupClass=group
usernameAttribute=sAMAccountName
memberOfAttribute=memberOf
groupMembersAttribute=member
fullNameAttribute=cn
emailAttribute=mail</pre> 
       </div>
      </div>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre># LDAP attribute names for OpenLDAP
userClass=inetOrgPerson
groupClass=groupofnames
usernameAttribute=uid
memberOfAttribute=
groupMembersAttribute=member
fullNameAttribute=cn
emailAttribute=mail</pre> 
       </div>
      </div>
      <h2 id="LDAPPropertiesFile-Mappings"><strong>Mappings</strong></h2>
      <p>These properties map LDAP groups and user DNs to a Rhapsody access group. They give&nbsp;all users in specific LDAP groups or&nbsp;specific LDAP users access&nbsp;to Rhapsody by assigning them to one of more Rhapsody access groups. The default Rhapsody groups are Administrator, Developer and Monitoring.</p>
      <div class="confluence-information-macro confluence-information-macro-note">
       <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span>
       <div class="confluence-information-macro-body">
        <p><span>The <span>group and user </span>mappings are case-sensitive.</span></p>
       </div>
      </div>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre>group.1.dn=CN=Rhapsody Admins,OU=Groups,DC=acmelabs,DC=internal
group.1.accessGroup=Administrator

group.2.dn=CN=Rhapsody Developers,OU=Groups,DC=acmelabs,DC=internal
group.2.accessGroup=Developer

group.3.dn=CN=Rhapsody Monitors,OU=Groups,DC=acmelabs,DC=internal
group.3.accessGroup=Monitoring
&nbsp;
group.4.dn=CN=Rhapsody DevOps,OU=Groups,DC=acmelabs,DC=internal
group.4.accessGroup.1=Developer
group.4.accessGroup.2=Monitoring

user.1.dn=CN=John Doe,OU=Users,DC=acmelabs,DC=internal
user.1.accessGroup=Administrator

user.2.dn=CN=Richard Roe,OU=Users,DC=acmelabs,DC=internal
user.2.accessGroup.1=Monitoring
user.2.accessGroup.2=Developer</pre> 
       </div>
      </div>
      <p>In the preceding example, the default access groups contain the following LDAP groups and users:</p>
      <ul>
       <li>Administrator:
        <ul>
         <li>All users in the Rhapsody Admins LDAP group (<code>CN=Rhapsody Admins,OU=Groups,DC=acmelabs,DC=internal)</code>.</li>
         <li>John Doe&nbsp;<code>(CN=John Doe,OU=Users,DC=acmelabs,DC=internal</code>).</li>
        </ul></li>
       <li>Developer:
        <ul>
         <li>All users&nbsp;in the Rhapsody Developers LDAP group (<code>CN=Rhapsody Developers,OU=Groups,DC=acmelabs,DC=internal</code>).</li>
         <li><p>All users&nbsp;in the Rhapsody DevOps LDAP group&nbsp;<code>(CN=Rhapsody DevOps,OU=Groups,DC=acmelabs,DC=internal)</code>.</p></li>
         <li>Richard Roe (<code>CN=Richard Roe,OU=Users,DC=acmelabs,DC=internal</code>).</li>
        </ul></li>
       <li>Monitoring:
        <ul>
         <li>All users&nbsp;in the Rhapsody Monitors LDAP group (<code>CN=Rhapsody Monitors,OU=Groups,DC=acmelabs,DC=internal</code>).</li>
         <li><p>All users&nbsp;in the&nbsp;Rhapsody DevOps LDAP group&nbsp;<code>(CN=Rhapsody DevOps,OU=Groups,DC=acmelabs,DC=internal)</code>.</p></li>
         <li><p>Richard Roe (<code>CN=Richard Roe,OU=Users,DC=acmelabs,DC=internal</code>).</p></li>
        </ul></li>
      </ul>
      <h2 id="LDAPPropertiesFile-AdministratorLoginonFailure">Administrator Login on Failure</h2>
      <p>This property enables or disables the ability of an Administrator user to log in if the LDAP server is unavailable. This property is false by default. Note that if LDAP is enabled,&nbsp;all local user accounts are disabled, including Administrator user.</p>
      <div class="confluence-information-macro confluence-information-macro-note">
       <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span>
       <div class="confluence-information-macro-body">
        <p>Enabling this property may reduce the security of your engine unless the Administrator password is secure.</p>
       </div>
      </div>
      <div class="preformatted panel" style="border-width: 1px;">
       <div class="preformattedContent panelContent"> 
        <pre>## Allow the "Administrator" user to login when the LDAP server is unreachable. If this property
## is enabled the Administrator user should have a secure password. To update the password for
## the Administrator user LDAP needs to be disabled then enabled again once the change is made.
#ldap.failover.administrator.enabled=false</pre> 
       </div>
      </div>
      <p> </p> 
     </div>  
    </div> 
   </div>  
  </div>   
 </body>
</html>