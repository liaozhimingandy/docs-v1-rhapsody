<!doctype html>
<html>
 <head> 
  <title>JavaScript Functions</title> 
  <link rel="stylesheet" href="styles/site.css" type="text/css"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <link rel="stylesheet" href="styles/icons.css" type="text/css">
  <script src="js/jquery.min.js"></script>
  <script src="tree/collapsibleTreeMenu.js"></script>
  <link href="tree/collapsibleTreeMenu.css" rel="stylesheet" type="text/css">
 </head> 
 <body class="theme-default aui-theme-default"> 
  <div id="page"> 
   <div id="main" class="aui-page-panel"> 
    <div id="main-header"> 
     <div id="breadcrumb-section"> 
      <ol id="breadcrumbs">  
       <li> <span><a href="Rhapsody-Integration-Engine-6.5_133160975.html">Rhapsody Integration Engine 6.5</a></span> </li> 
       <li> <span><a href="Developing-Rhapsody_133161055.html">Developing Rhapsody</a></span> </li> 
       <li> <span><a href="Rhapsody-Objects_133161790.html">Rhapsody Objects</a></span> </li> 
       <li> <span><a href="Rhapsody-Components_133161994.html">Rhapsody Components</a></span> </li> 
       <li> <span><a href="Filters_133162681.html">Filters</a></span> </li> 
       <li> <span><a href="Filter-Types_133162712.html">Filter Types</a></span> </li> 
       <li> <span><a href="HL7-Filters_133163076.html">HL7 Filters</a></span> </li> 
       <li> <span><a href="HL7-Message-Modifier_133163077.html">HL7 Message Modifier</a></span> </li> 
       <li> <span><a href="Configure_133163111.html">Configure</a></span> </li> 
       <li> <span><a href="Adding-a-Rule_133163114.html">Adding a Rule</a></span> </li> 
      </ol> 
     </div> 
     <h1 id="title-heading" class="pagetitle"> <span id="title-text">JavaScript Functions</span> </h1> 
    </div> 
    <div id="content" class="view">  
     <div id="main-content" class="wiki-content group"> 
      <p> <map id="gliffy-map-133163149-3566" name="gliffy-map-133163149-3566"></map> </p>
      <table width="100%" class="gliffy-macro-table"> 
       <tbody>
        <tr> 
         <td> 
          <table class="gliffy-macro-inner-table"> 
           <caption align="bottom"> 
           </caption> 
           <tbody>
            <tr> 
             <td> <img style="border: none; width: 602px;" usemap="#gliffy-map-133163149-3566" src="attachments/133163143/133163148.png" alt="" class="gliffy-macro-image"> </td> 
            </tr> 
           </tbody>
          </table> </td> 
        </tr> 
       </tbody>
      </table> 
      <p></p>
      <h2 id="JavaScriptFunctions-JavaScriptActions">JavaScript Actions</h2>
      <p>The action JavaScript function allows you to perform complex actions that are not possible by using standard actions. The target operand is set to the value returned by a JavaScript function you write. The function takes auxiliary operands in the form of parameters.</p>
      <h3 id="JavaScriptFunctions-AddinganActionJavaScriptFunction">Adding an Action JavaScript Function</h3>
      <p>To set up an action JavaScript function:</p>
      <ol>
       <li>Enter the type and value of the target operand.</li>
       <li><p>Select the <strong>Using JavaScript</strong> operator to display the Action JavaScript form:</p><p> <map id="gliffy-map-133163145-7785" name="gliffy-map-133163145-7785"></map> </p>
        <table width="100%" class="gliffy-macro-table"> 
         <tbody>
          <tr> 
           <td> 
            <table class="gliffy-macro-inner-table"> 
             <caption align="bottom"> 
             </caption> 
             <tbody>
              <tr> 
               <td> <img style="border: none; width: 848px;" usemap="#gliffy-map-133163145-7785" src="attachments/133163143/133163144.png" alt="" class="gliffy-macro-image"> </td> 
              </tr> 
             </tbody>
            </table> </td> 
          </tr> 
         </tbody>
        </table> <p></p></li>
       <li>Enter a description of what the function does in the <strong>Description</strong> field.</li>
       <li><p>Add the parameters that are to be passed into your JavaScript function. For each one add:</p>
        <div class="table-wrap">
         <table class="confluenceTable">
          <tbody>
           <tr>
            <th class="confluenceTh"><p>Parameter Attribute</p></th>
            <th class="confluenceTh"><p>Description</p></th>
           </tr>
           <tr>
            <td class="confluenceTd"><p>Parameter Name</p></td>
            <td class="confluenceTd"><p>A user-defined name for the parameter.</p>
             <div class="confluence-information-macro confluence-information-macro-note">
              <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span>
              <div class="confluence-information-macro-body">
               <p>For symbols and keywords that are not permitted by JavaScript for parameter names, refer to <a href="#JavaScriptFunctions-JavaScriptNamingRules">JavaScript Naming Rules</a> for details.</p>
              </div>
             </div></td>
           </tr>
           <tr>
            <td class="confluenceTd"><p>Parameter Value</p></td>
            <td class="confluenceTd"><p>The auxiliary operand the parameter is set to.</p></td>
           </tr>
          </tbody>
         </table>
        </div></li>
       <li><p>Write the JavaScript function in the function code text box.</p>
        <div class="confluence-information-macro confluence-information-macro-information">
         <span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span>
         <div class="confluence-information-macro-body">
          <p>Refer to <a href="#JavaScriptFunctions-WritingActionJavaScriptFunctions">Writing Action JavaScript Functions</a> for details.</p>
         </div>
        </div></li>
       <li>Click the <strong>OK</strong> link to save your changes or the <strong>Cancel</strong> link to discard them.</li>
      </ol>
      <h3 id="JavaScriptFunctions-WritingActionJavaScriptFunctions">Writing Action JavaScript Functions</h3>
      <p>Action JavaScript functions are of the form:</p>
      <div class="code panel pdl" style="border-width: 1px;">
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: js; gutter: false; theme: Confluence" data-theme="Confluence">function action(parameter_1, parameter_2,..., parameter_n) {
    &lt;expression_1&gt;;
    &lt;expression_2&gt;;
    ...
    &lt;expression_n&gt;;
    
    return (value);
}
</pre> 
       </div>
      </div>
      <p>It must return a value:</p>
      <ul>
       <li>If a string value is returned, then it is used directly.</li>
       <li>If a boolean value is returned, then it is converted to a string of <code>true</code> or <code>false</code>. No translation is performed here.</li>
       <li>If a number value is returned, then it is converted to a string using the default numerical formatter on the system. If custom formatting is required, then this should be done in the JavaScript code and a string value returned instead.</li>
       <li>If null is returned, then it is treated as an empty string.</li>
       <li>Any other return value (including undefined) is treated as a fatal error.</li>
      </ul>
      <h2 id="JavaScriptFunctions-JavaScriptConditions">JavaScript Conditions</h2>
      <p>The conditional JavaScript function allow you to create complex conditions that are not possible by using standard conditions. The function takes subject and object operands in the form of parameters and returns a boolean value.</p>
      <h3 id="JavaScriptFunctions-AddingaConditionalJavaScriptFunction">Adding a Conditional JavaScript Function</h3>
      <p>To set up a conditional JavaScript function:</p>
      <ol>
       <li><p>Select <strong>JavaScript</strong> in the subject operand drop-down list to display the Conditional JavaScript form:</p><p> <map id="gliffy-map-133163147-5244" name="gliffy-map-133163147-5244"></map> </p>
        <table width="100%" class="gliffy-macro-table"> 
         <tbody>
          <tr> 
           <td> 
            <table class="gliffy-macro-inner-table"> 
             <caption align="bottom"> 
             </caption> 
             <tbody>
              <tr> 
               <td> <img style="border: none; width: 848px;" usemap="#gliffy-map-133163147-5244" src="attachments/133163143/133163146.png" alt="" class="gliffy-macro-image"> </td> 
              </tr> 
             </tbody>
            </table> </td> 
          </tr> 
         </tbody>
        </table> <p></p></li>
       <li>Enter a description of what the function does in the <strong>Description</strong> field.</li>
       <li><p>Add the parameters that are to be passed into your JavaScript function. For each one populate the following fields:</p>
        <div class="table-wrap">
         <table class="confluenceTable">
          <tbody>
           <tr>
            <th class="confluenceTh"><p>Parameter Attribute</p></th>
            <th class="confluenceTh"><p>Description</p></th>
           </tr>
           <tr>
            <td class="confluenceTd"><p>Parameter Name</p></td>
            <td class="confluenceTd"><p>A user-defined name for the parameter.</p>
             <div class="confluence-information-macro confluence-information-macro-note">
              <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span>
              <div class="confluence-information-macro-body">
               <p>For symbols and keywords that are not permitted by JavaScript for parameter names, refer to <a href="#JavaScriptFunctions-JavaScriptNamingRules">JavaScript Naming Rules</a> for details.</p>
              </div>
             </div></td>
           </tr>
           <tr>
            <td class="confluenceTd"><p>Parameter Value</p></td>
            <td class="confluenceTd"><p>The subject or object operand the parameter is set to.</p></td>
           </tr>
          </tbody>
         </table>
        </div></li>
       <li><p>Write the JavaScript function in the function code text box.</p>
        <div class="confluence-information-macro confluence-information-macro-information">
         <span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span>
         <div class="confluence-information-macro-body">
          <p>Refer to <a href="#JavaScriptFunctions-WritingConditionalJavaScriptFunctions">Writing Conditional JavaScript Functions</a> for details.</p>
         </div>
        </div></li>
       <li>Click the <strong>OK</strong> link to save your changes or the <strong>Cancel</strong> link to discard them.</li>
      </ol>
      <h3 id="JavaScriptFunctions-WritingConditionalJavaScriptFunctions">Writing Conditional JavaScript Functions</h3>
      <p>Conditional JavaScript functions are of the form:</p>
      <div class="code panel pdl" style="border-width: 1px;">
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">function action(parameter_1, parameter_2,..., parameter_n) {
    if {
        &lt;expression_1&gt;;
        &lt;expression_2&gt;;
        ...
        &lt;expression_n&gt;;
    
        return (value);
    }
}
</pre> 
       </div>
      </div>
      <p>They must return a boolean value:</p>
      <ul>
       <li>If a boolean value is returned, then it is used directly.</li>
       <li>If a number is returned, then it is treated as false if zero and true if non-zero.</li>
       <li>Any other return value (including null and undefined) is treated as a fatal error.</li>
      </ul>
      <h2 id="JavaScriptFunctions-JavaScriptObjects">JavaScript Objects</h2>
      <p>The HL7 Message Modifier filter provides the pre-defined JavaScript object&nbsp;<code>separators</code> <span>&nbsp;which returns the value of a separator in MSH.2. It has the following properties:</span></p>
      <ul>
       <li><code>separators.field</code>&nbsp;returns the field separator.</li>
       <li><code>separators.component</code>&nbsp;returns the component separator.</li>
       <li><code>separators.subcomponent</code>&nbsp;returns the subcomponent separator.</li>
      </ul>
      <p>For example:</p>
      <div class="code panel pdl" style="border-width: 1px;">
       <div class="codeContent panelContent pdl"> 
        <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">return 'a' + separators.component + 'b1' + separators.subcomponent + 'b2';
</pre> 
       </div>
      </div>
      <p>returns&nbsp;<code>a^b1&amp;b2</code>&nbsp;when the default separators are being used in the message.</p>
      <div class="confluence-information-macro confluence-information-macro-note">
       <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span>
       <div class="confluence-information-macro-body">
        <p>If you are modifying a segment that is not an MSH segment, then the default separators are displayed in the <strong>Result Panel</strong>. To preview the correct separators used in the sample message, refer to the <strong>Sample Result Panel</strong> in the segment's change group or the <strong>All Changes</strong>.</p>
       </div>
      </div>
      <p>You can also use the global&nbsp;<span>JavaScript object&nbsp;</span> <code>dateChangeFormat</code> <span>&nbsp;to transform date-time formats. Refer to&nbsp;</span> <a href="Global-Functions_133161395.html#GlobalFunctions-dateChangeFormat">Global Functions</a> <span>&nbsp;for details.</span></p>
      <h2 id="JavaScriptFunctions-JavaScriptNamingRules">JavaScript Naming Rules</h2>
      <p>The following characters and words are not permitted for parameter names in JavaScript:</p>
      <ul>
       <li><p>Words beginning with <code>$</code>, <code>_</code>, non-numeric, or <a href="#JavaScriptFunctions-ProhibitedCharacters">prohibited characters</a>.</p>
        <div class="confluence-information-macro confluence-information-macro-information">
         <span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span>
         <div class="confluence-information-macro-body">
          <p>Unicode characters, however, are allowed as either the character or escaped using the <code>\uXXXX</code> format (for example, <code>\u0BAF</code>).</p>
         </div>
        </div></li>
       <li><a href="#JavaScriptFunctions-ReservedWords">Reserved words</a> and <a href="#JavaScriptFunctions-Pre-definedJavaScriptObjects">pre-defined JavaScript objects</a>.</li>
       <li><a href="Global-Variables_133162428.html">Global variables</a>.</li>
       <li>Names must be unique within a JavaScript function.</li>
      </ul>
      <h3 id="JavaScriptFunctions-ProhibitedCharacters">Prohibited Characters</h3>
      <p>The following characters in a parameter name render it invalid and are therefore prohibited:</p>
      <ul>
       <li>Non-printable characters.</li>
       <li>Whitespace.</li>
       <li>JavaScript operators (for example, <code>-</code>, <code>+</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>\</code>, <code>(</code>, <code>)</code>, <code>[</code>, <code>]</code>, etc.).</li>
      </ul>
      <h3 id="JavaScriptFunctions-GlobalVariables">Global Variables</h3>
      <p>The following global variables cannot be used as parameter names:</p>
      <ul>
       <li><code>NaN</code>.</li>
       <li><code>infinity</code>.</li>
       <li><code>undefined</code>.</li>
      </ul>
      <h3 id="JavaScriptFunctions-ReservedWords">Reserved Words</h3>
      <div class="table-wrap">
       <table class="confluenceTable">
        <tbody>
         <tr>
          <td class="confluenceTd"><p><code>arguments</code></p></td>
          <td class="confluenceTd"><p><code>break</code></p></td>
          <td class="confluenceTd"><p><code>case</code><br><code>catch</code><br><code>class</code><br><code>const</code><br><code>continue</code></p></td>
          <td class="confluenceTd"><p><code>dateChangeFormat</code><br><code>debugger</code><br><code>default</code><br><code>delete</code><br><code>do</code></p></td>
          <td class="confluenceTd"><p><code>else</code><br><code>enum</code><br><code>eval</code><br><code>export</code><br><code>extends</code></p></td>
          <td class="confluenceTd"><p><code>false</code><br><code>finally</code><br><code>for</code><br><code>function</code></p></td>
          <td class="confluenceTd"><p><code>if</code><br><code>implements</code><br><code>import</code><br><code>in</code><br><code>instanceof</code><br><code>interface</code></p></td>
          <td class="confluenceTd"><p><code>let</code></p></td>
         </tr>
         <tr>
          <td class="confluenceTd"><p><code>new</code><br><code>null</code></p></td>
          <td class="confluenceTd"><p><code>package</code><br><code>private</code><br><code>protected</code><br><code>public</code></p></td>
          <td class="confluenceTd"><p><code>return</code></p></td>
          <td class="confluenceTd"><p><code>separators</code><br><code>static</code><br><code>super</code><br><code>switch</code></p></td>
          <td class="confluenceTd"><p><code>this</code><br><code>throw</code><br><code>true</code><br><code>try</code><br><code>typeof</code></p></td>
          <td class="confluenceTd"><p><code>var</code><br><code>void</code></p></td>
          <td class="confluenceTd"><p><code>while</code><br><code>with</code></p></td>
          <td class="confluenceTd"><p><code>yield</code></p></td>
         </tr>
        </tbody>
       </table>
      </div>
      <h2 id="JavaScriptFunctions-JavaScriptErrors">JavaScript Errors</h2>
      <p>Refer to <a href="Error-Handling_133163249.html">Error Handling</a> for details.</p>
      <h2 id="JavaScriptFunctions-AdditionalInformation">Additional Information</h2>
      <ul>
       <li>Refer to&nbsp;<a href="JavaScript-Object-Reference_133161390.html">JavaScript Object Reference</a>&nbsp;for details on JavaScript and the objects that Rhapsody exposes.</li>
       <li>Refer to&nbsp;<a href="Shared-JavaScript-Libraries_133161861.html">Shared JavaScript Libraries</a>&nbsp;for details on how to manage shared&nbsp;JavaScript libraries.</li>
      </ul>
      <p> </p> 
     </div>  
    </div> 
   </div>  
  </div>   
 </body>
</html>